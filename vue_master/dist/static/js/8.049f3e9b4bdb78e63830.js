webpackJsonp([8],{"3cXf":function(t,e,a){t.exports={default:a("L+o2"),__esModule:!0}},F49w:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("4YfN"),n=a.n(i),r=a("3cXf"),o=a.n(r),s=a("HtDH"),c=a("84iU"),d=a.n(c),v={components:{},name:"code",data:function(){return{code:"",imgUrl:"",formData:{},vdstate:!1,states:!1,canvasShow:!0,tipShow:!1,errorShow:!1}},methods:{handleClick:function(){var t=this,e=this;if(!this.vdstate)return!1;if(!e.states){var a=this.$refs.vd,i=this.$refs.cav;i.getContext("2d").drawImage(a,0,0,200,200);var n=i.toDataURL("image/jpg"),r=this.dataURItoBlob(n,"camera.jpg"),o=new FormData;o.append("file",r),this.imgUrl=n,Object(s.a)(o).then(function(a){if(console.log(a.data.success),!a.data.success)return!1;d()({method:"post",url:"/api/sys/faceLogin/"+t.$route.query.code,data:o}).then(function(t){console.log(t),e.states=!0,e.canvasShow=!1,t.data.success?e.tipShow=!0:e.errorShow=!0}).catch(function(t){console.log(t)})})}},dataURItoBlob:function(t){var e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var a=t.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return new Blob([i],{type:a})}},created:function(){var t=this;o()(navigator);this.$nextTick(function(){var e=t;var a=t.$refs.vd;t.$refs.cav.getContext("2d");navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia?function(t,a,i){var r=e.$refs.vd;navigator.mediaDevices.getUserMedia?(n()({},t,{video:!0}),navigator.mediaDevices.getUserMedia(t).then(function(t){r.srcObject=t,r.play(),e.vdstate=!0}).catch(i)):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(t).then(a).catch(i):navigator.mozGetUserMedia?navagator.mozGetUserMedia(t).then(a).catch(i):navigator.getUserMedia&&navigator.getUserMedia(t).then(a).catch(i)}({video:{width:200,height:200}},function(t){e.vdstate=!0;var i=window.URL||window.webkitURL;a.src=i.createObjectURL(t),a.play()},function(t){alert(t),console.log("访问用户媒体设备失败：",t.name,t.message)}):alert("你的浏览器不支持访问用户媒体设备")})},mounted:function(){setInterval(this.handleClick,3e3)},updated:function(){}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.canvasShow,expression:"canvasShow"}],staticClass:"login-form"},[a("p",{staticClass:"titleInfo"},[t._v("请把正脸对准摄像头")]),t._v(" "),a("div",{staticClass:"regInfo"},[a("div",{staticClass:"canvas"},[a("video",{ref:"vd",staticStyle:{width:"200px",height:"200px"},attrs:{id:"video",autoplay:"",playsinline:""}}),t._v(" "),a("canvas",{ref:"cav",attrs:{id:"canvas",width:"200",height:"200"}})])]),t._v(" "),a("form",{ref:"myForm",attrs:{id:"myForm",action:"/api/frame/facelogin/checkFace",method:"post",enctype:"multipart/form-data"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tipShow,expression:"tipShow"}],staticClass:"tipShow"},[a("el-alert",{attrs:{title:"验证成功",type:"success",center:"",closable:!1,"show-icon":""}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.errorShow,expression:"errorShow"}],staticClass:"tipShow"},[a("el-alert",{attrs:{title:"验证失败",type:"error",center:"",closable:!1,"show-icon":""}})],1)])},staticRenderFns:[]};var u=a("C7Lr")(v,l,!1,function(t){a("jZrG"),a("LxBa")},"data-v-6e5706be",null);e.default=u.exports},HtDH:function(t,e,a){"use strict";a.d(e,"c",function(){return c}),a.d(e,"b",function(){return d}),a.d(e,"a",function(){return v});var i=a("4YfN"),n=a.n(i),r=a("vLgD"),o=a("84iU"),s=a.n(o),c=function(t){return Object(r.a)("/sys/faceLogin/qrcode","get",t)},d=function(t){return Object(r.a)("/sys/faceLogin/qrcode/"+t.code,"get",t)},v=function(t){var e={};return e.data=t,e.headers={"Cache-Control":"no-cache","Content-Type":"multipart/form-data"},e.transformRequest=t,s.a.request(n()({baseURL:"",method:"post",url:"/sys/faceLogin/checkFace"},e))}},"L+o2":function(t,e,a){var i=a("ZuHZ"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},LxBa:function(t,e){},jZrG:function(t,e){}});